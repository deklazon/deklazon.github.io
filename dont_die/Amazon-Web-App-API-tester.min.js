function _AmazonCallbackObserver(a){this._init(a)}
_AmazonCallbackObserver.prototype={CALLBACK_DELAY_MS:2,_handlers:null,_enums:null,_init:function(a){this._handlers={};this._enums=[];for(var a=a||[],b,c=0;c<a.length;c++)b=a[c],this._handlers[b]=null},clearHandlers:function(){var a=null;for(a in this._handlers)this._handlers[a]=null},registerHandlers:function(a){var a=a||{},b,c=null;for(c in this._handlers)(b=a[c])&&(this._handlers[c]=b)},isRegistered:function(){for(var a in this._handlers)if(null!=this._handlers[a])return!0;return!1},runCallback:function(a,
b){if(a&&this._handlers[a]){var c=this;setTimeout(function(){c._handlers[a](b)},this.CALLBACK_DELAY_MS)}}};var _AmazonCache=function(){};_AmazonCache.WebImpl=function(a){this._init(a)};
_AmazonCache.WebImpl.prototype={_amazonClient:null,_init:function(a){this._amazonClient=a},clearAppCache:function(){this._amazonClient.Cache.clearAppCache()},clearFormData:function(){this._amazonClient.Cache.clearFormData()},clearHistory:function(){this._amazonClient.Cache.clearHistory()},clearAllCookies:function(){this._amazonClient.Cache.clearAllCookies()},clearExpiredCookies:function(){this._amazonClient.Cache.clearExpiredCookies()},clearSessionCookies:function(){this._amazonClient.Cache.clearSessionCookies()}};
var _AmazonInAppPurchasing=function(){};
_AmazonInAppPurchasing.prototype={ItemType:new _AmazonEnum(["CONSUMABLE","ENTITLEMENT","SUBSCRIPTIONS"]),PurchaseStatus:new _AmazonEnum(["INVALID_INPUT","SUCCESSFUL","FAILED","INVALID_SKU","ALREADY_ENTITLED"]),ItemDataStatus:new _AmazonEnum(["INVALID_INPUT","SUCCESSFUL","FAILED","SUCCESSFUL_WITH_UNAVAILABLE_SKU"]),PurchaseUpdatesStatus:new _AmazonEnum(["INVALID_INPUT","SUCCESSFUL","FAILED"]),UserIdStatus:new _AmazonEnum(["SUCCESSFUL","FAILED"]),Offset:{BEGINNING:"BEGINNING"},_generateJSRequestId:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,
function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})},_validatePurchaseItem:function(a){if("string"===typeof a)return!0;console.log("purchaseItem takes a string sku");return!1},_validateGetItemData:function(a){if(a instanceof Array&&0<a.length)return!0;console.log("getItemData takes an array of length > 0");return!1},_validateGetPurchaseUpdates:function(a){if(a==this.Offset.BEGINNING||"string"==typeof a)return!0;console.log("getPurchaseUpdates takes a string offset or Offset.BEGINNING");
return!1}};_AmazonInAppPurchasing.WebImpl=function(a){this._init(a)};
(function(){_AmazonInAppPurchasing.WebImpl.prototype=new _AmazonInAppPurchasing;var a={PurchasingObserver:new _AmazonCallbackObserver(["onSdkAvailable","onGetUserIdResponse","onItemDataResponse","onPurchaseResponse","onPurchaseUpdatesResponse"]),_amazonClient:null,_init:function(a){this._amazonClient=a},_runCallback:function(a,b){this.PurchasingObserver.runCallback(a,b)},registerObserver:function(a){this.PurchasingObserver.registerHandlers(a);this._amazonClient.IAP.registerObserver()},_pingObserver:function(){this.PurchasingObserver.isRegistered()?
this._amazonClient.IAP.ackObserver():console.log("got a callback for in-app-purchasing but observer not registered, queueing")},getUserId:function(){var a=this._generateJSRequestId();this._amazonClient.IAP.getUserId(a);return a},purchaseItem:function(a){var b=this._generateJSRequestId();if(!this._validatePurchaseItem(a))return this._runCallback("purchaseItem",{jsReqId:b,purchaseRequestStatus:"INVALID_INPUT"}),b;this._amazonClient.IAP.purchaseItem(b,a);return b},getItemData:function(a){var b=this._generateJSRequestId();
if(!this._validateGetItemData(a))return this._runCallback("onItemDataResponse",{jsReqId:b,itemDataRequestStatus:"INVALID_INPUT"}),b;this._amazonClient.IAP.getItemData(b,a.join(","));return b},getPurchaseUpdates:function(a){var b=this._generateJSRequestId();if(!this._validateGetPurchaseUpdates(a))return this._runCallback("onPurchaseUpdatesResponse",{jsReqId:b,purchaseUpdatesRequestStatus:"INVALID_INPUT"}),b;this._amazonClient.IAP.getPurchaseUpdates(b,a);return b}},b;for(b in a)_AmazonInAppPurchasing.WebImpl.prototype[b]=
a[b]})();function _AmazonWebAppApiTester(){this._init()}
_AmazonWebAppApiTester.prototype={_CLOUD_SYNC_DATA_KEY:"mock-cloud-sync-data",_CLOUD_SYNC_LAST_TOUCH_KEY:"mock-cloud-sync-last-touch",_ENTITLEMENT_KEY:"mock-entitlement",_amazonServices:null,_storage:null,_callbacks:null,_items:null,_IAP:null,_GameCircle:null,_init:function(){this._callbacks={};this._items={};this._determineStorage();this.setMockItems(this._getMockItems())},initialize:function(a){this._amazonServices=a},get IAP(){null==this._IAP&&null!=this._amazonServices&&(this._IAP=new _MockAmazonJavascriptInAppPurchasingBindings(this._amazonServices,
this));return this._IAP},get GameCircle(){null==this._GameCircle&&null!=this._amazonServices&&(this._GameCircle=new _MockAmazonJavascriptGameCircleBindings(this._amazonServices,this));return this._GameCircle},get Cache(){return null},_determineStorage:function(){if("undefined"===typeof localStorage||null==localStorage){var a=this;this._storage={_items:{},setItem:function(b,c){a._storage._items[b]=c},getItem:function(b){return a._storage._items[b]},removeItem:function(b){a._storage._items[b]&&delete a._storage._items[b]}}}else this._storage=
localStorage},_getMockItems:function(){if("undefined"!==typeof window){for(var a=["amazon.sdktester.json","/amazon.sdktester.json","/static/amazon.sdktester.json"],b=new XMLHttpRequest,c=0;c<a.length;c++)if(b.open("GET",a[c],!1),b.send(),200==b.status)return JSON.parse(b.responseText);return null}},getCloudSyncData:function(){return this._loadAsJSON(this._CLOUD_SYNC_DATA_KEY)},setCloudSyncData:function(a){this._saveAsJSON(this._CLOUD_SYNC_DATA_KEY,a)},clearCloudSyncData:function(){this._storage.removeItem(this._CLOUD_SYNC_DATA_KEY);
this._saveAsJSON(this._CLOUD_SYNC_LAST_TOUCH_KEY,{lastTouch:!1})},touchCloudSync:function(){this._saveAsJSON(this._CLOUD_SYNC_LAST_TOUCH_KEY,{lastTouch:!0})},getCloudSyncLastTouch:function(){var a=this._loadAsJSON(this._CLOUD_SYNC_LAST_TOUCH_KEY);return a&&a.lastTouch},getMockItemData:function(a){(a=this._items[a])||(a=null);return a},setMockItems:function(a){this._items=a},getEntitled:function(){return this._loadAsJSON(this._ENTITLEMENT_KEY)},grantEntitlement:function(a){var b=this.getEntitled();
b[a]=!0;this._saveAsJSON(this._ENTITLEMENT_KEY,b)},clearEntitlements:function(){this._saveAsJSON(this._ENTITLEMENT_KEY,{})},revokeEntitlement:function(a){var b=this.getEntitled();b[a]&&delete b[a];this._saveAsJSON(this._ENTITLEMENT_KEY,b)},isEntitled:function(a){return null!=this.getEntitled()[a]},_saveAsJSON:function(a,b){"undefined"!=typeof JSON&&(b=JSON.stringify(b));this._storage.setItem(a,b)},_loadAsJSON:function(a){a=this._storage.getItem(a);return null!=a?("undefined"!=typeof JSON&&(a=JSON.parse(a)),
a):{}},setCallbackForMethod:function(a,b){this._callbacks[a]=b;console.log("Callback set for "+a)},getCallbackForMethod:function(a){var b=this._callbacks[a];return b?(delete this._callbacks[a],b):null},_createReceipt:function(a){var b=null,c=this.getMockItemData(a);return c?(c.itemType==this._amazonServices.IAP.ItemType.SUBSCRIPTION&&(b=(new Date).getTime(),b={startDate:b,endDate:b+2592E6}),{itemType:c.itemType,purchaseToken:(new Date).getTime(),sku:a,subscriptionPeriod:b}):null},createMockCallback:function(a,
b){switch(a){case "IAP.registerObserver":return{callbackName:"onSdkAvailable",response:{isSandboxMode:!0}};case "IAP.getUserId":var c=b[0];return{callbackName:"onGetUserIdResponse",response:{jsReqId:c,requestId:"IAP.getUserId"+new Date,userId:"userId",userIdRequestStatus:"SUCCESSFUL"}};case "IAP.getItemData":var c=b[0],c={jsReqId:c,requestId:"IAP.getItemData"+new Date,userId:"userId",itemDataRequestStatus:this._amazonServices.IAP.ItemDataStatus.SUCCESSFUL,itemData:{}},g=b[1].split(","),i;for(i in g){var f=
g[i];c.itemData[f]=this.getMockItemData(f);c.itemData[f].sku=f}return{callbackName:"onItemDataResponse",response:c};case "IAP.getPurchaseUpdates":c=b[0];c={jsReqId:c,requestId:"IAP.getPurchaseUpdates"+new Date,userId:"userId",revokedSkus:[],receipts:[],isMore:!1,offset:"",purchaseUpdatesRequestStatus:this._amazonServices.IAP.PurchaseUpdatesStatus.SUCCESSFUL};for(f in this.getEntitled())(i=this._createReceipt(f))&&c.receipts.push(i);return{callbackName:"onPurchaseUpdatesResponse",response:c};case "IAP.purchaseItem":return c=
b[0],f=b[1],c={jsReqId:c,requestId:"IAP.purchaseItem"+new Date,userId:"userId",purchaseRequestStatus:this._amazonServices.IAP.PurchaseStatus.SUCCESSFUL,receipt:{}},null==this.getMockItemData(f)?c.purchaseRequestStatus=this._amazonServices.IAP.PurchaseStatus.INVALID_SKU:this.isEntitled(f)?c.purchaseRequestStatus=this._amazonServices.IAP.PurchaseStatus.ALREADY_ENTITLED:(c.purchaseRequestStatus=this._amazonServices.IAP.PurchaseStatus.SUCCESSFUL,c.receipt=this._createReceipt(f)),{callbackName:"onPurchaseResponse",
response:c};case "GameCircle.initialize":return{callbackName:"onServiceReady",response:{}};case "GameCircle.synchronize":return c=b[0],f=this.getCloudSyncData(),c=c==this._amazonServices.GameCircle.ConflictStrategy.AUTO_RESOLVE_TO_IGNORE||this.getCloudSyncLastTouch()||!f.data?{callbackName:"onAlreadySynchronized",response:{}}:{callbackName:"onNewGameData",response:{data:f.data}},this.setCloudSyncData(f),this.touchCloudSync(),c;case "GameCircle.synchronizeProgress":return c=b[0],i=b[1],g=b[2],f=this.getCloudSyncData(),
this.getCloudSyncLastTouch()||g===f.data?c={callbackName:"onAlreadySynchronized",response:{}}:i==this._amazonServices.GameCircle.ConflictStrategy.AUTO_RESOLVE_TO_IGNORE?(f.data=g,f.description=c,c={callbackName:"onGameUploadSuccess",response:{}}):c={callbackName:"onNewGameData",response:{data:f.data,description:f.description}},this.setCloudSyncData(f),this.touchCloudSync(),c;default:return console.log("no default mock callback for this method "+a),null}}};
function _MockAmazonJavascriptInAppPurchasingBindings(a,b){this._init(a,b)}
_MockAmazonJavascriptInAppPurchasingBindings.prototype={_amazonServices:null,_webAppApiTester:null,_init:function(a,b){this._amazonServices=a;this._webAppApiTester=b},_runDebugModeCallback:function(a,b){var c=this._webAppApiTester.getCallbackForMethod(a);null==c&&(c=this._webAppApiTester.createMockCallback(a,b));this._amazonServices.IAP._runCallback(c.callbackName,c.response)},registerObserver:function(){this._runDebugModeCallback("IAP.registerObserver",[])},getUserId:function(a){this._runDebugModeCallback("IAP.getUserId",
[a])},getItemData:function(a,b){this._runDebugModeCallback("IAP.getItemData",[a,b])},getPurchaseUpdates:function(a,b){this._runDebugModeCallback("IAP.getPurchaseUpdates",[a,b])},purchaseItem:function(a,b){var c=[a,b],g=this._webAppApiTester.getCallbackForMethod("IAP.purchaseItem"),i=this._webAppApiTester.getMockItemData(b);if(null!=g)this._amazonServices.IAP._runCallback(g.callbackName,g.response);else if(g=this._webAppApiTester.createMockCallback("IAP.purchaseItem",c),"undefined"==typeof JSON||g.response.purchaseRequestStatus==
this._amazonServices.IAP.PurchaseStatus.INVALID_SKU)this._amazonServices.IAP._runCallback(g.callbackName,g.response),i&&g.response.purchaseRequestStatus!=this._amazonServices.IAP.PurchaseStatus.ALREADY_ENTITLED&&i.itemType!=this._amazonServices.IAP.ItemType.CONSUMABLE&&this._webAppApiTester.grantEntitlement(b);else{var f=this,k=document.createElement("div");k.id="AmazonServicesPurchaseItem";c=document.createElement("div");c.style.position="fixed";c.style.width="100%";c.style.height="100%";c.style.backgroundColor=
"black";c.style.opacity=0.75;c.style.top="0px";c.style.left="0px";k.appendChild(c);c=document.createElement("div");c.style.position="fixed";c.style.width="60%";c.style.height="75%";c.style.top="5%";c.style.left="20%";c.style.fontFamily="sans-serif";c.style.backgroundColor="black";c.style.color="white";c.style.borderBottomColor="white";c.style.textAlign="left";c.style.paddingLeft="15px";var d=document.createElement("div");d.id="AmazonServicesPurchaseItem-Logo";d.style.textAlign="left";d.style.paddingLeft=
"5px";d.innerHTML='<img src="http://rialto-mas-dev.s3.amazonaws.com/images/nodpi/amazon_apps_logo.png" width="110" height="21" vspace="2"/>';c.appendChild(d);d=document.createElement("div");d.id="AmazonServicesPurchaseItem-Close";d.style.position="absolute";d.style.top="5px";d.style.right="5px";d.style.color="#bbb";d.style.fontSize="12px";d.style.verticalAlign="middle";var m=document.createElement("a");m.innerHTML='<img src="http://rialto-mas-dev.s3.amazonaws.com/images/nodpi/cancel.png"  height="20" border="0" />';
m.onclick=function(){document.body.removeChild(k);g.response.receipt={};g.response.purchaseRequestStatus=f._amazonServices.IAP.PurchaseStatus.FAILED;f._amazonServices.IAP._runCallback(g.callbackName,g.response)};d.appendChild(m);c.appendChild(d);d=document.createElement("hr");d.style.height="1px";d.style.borderWidth=0;d.style.backgroundColor="#333";c.appendChild(d);d=document.createElement("img");d.style.cssFloat="left";d.style.paddingRight="15px";d.src=i.smallIconUrl;c.appendChild(d);var d=document.createElement("div"),
n=document.createElement("div");n.id="AmazonServicesPurchaseItem-ThankYou";n.style.display="none";n.innerHTML="Thank You for purchasing <b>"+i.title+"</b>";d.appendChild(n);var p=document.createElement("div");p.id="AmazonServicesPurchaseItem-Pwnd";p.style.display="none";p.innerHTML="You already own <b>"+i.title+"</b>";d.appendChild(p);var j=document.createElement("div");j.id="AmazonServicesPurchaseItem-ItemTitle";j.style.marginTop="15px";j.style.marginBottom="15px";j.style.fontSize="16px";j.style.fontWeight=
"normal";j.innerHTML=i.title;d.appendChild(j);var l=document.createElement("div");l.id="AmazonServicesPurchaseItem-Processing";l.style.display="none";var e=document.createElement("div");e.id="AmazonServicesPurchaseItem-ProcessingMsg";e.style.cssFloat="left";e.style.clear="right";e.style.marginLeft="20px";e.style.paddingLeft="20px";e.style.backgroundImage="url(http://rialto-mas-dev.s3-website-us-east-1.amazonaws.com/images/nodpi/ajax-loader.gif)";e.style.backgroundRepeat="no-repeat";e.style.backgroundPosition=
"left center";e.style.backgroundSize="16px 16px";e.style.fontSize="20px";e.innerHTML="Processing<br/>";l.appendChild(e);d.appendChild(l);var h=document.createElement("button");h.id="AmazonServicesPurchaseItem-BuyButton";h.style.cssFloat="left";h.style.clear="right";h.style.height="30px";h.style.width="100px";h.style.borderRadius="4px";h.style.fontSize="18px";h.style.fontWeight="bold";h.style.color="white";h.style.borderTop="0.063rem solid #fed78b";h.style.borderBottom="0.063rem solid #a65f2c";h.style.backgroundImage=
"-webkit-gradient(linear, left bottom, left top, color-stop(0, #ed7723), color-stop(1, #faa719))";h.style.textShadow="0rem -0.063rem 0rem #8b4c16";h.innerHTML="$"+i.price;h.onclick=function(){l.style.display="block";h.style.display="none";setTimeout(function(){var a=g.response.purchaseRequestStatus==f._amazonServices.IAP.PurchaseStatus.ALREADY_ENTITLED;l.style.display="none";j.style.display="none";m.innerHTML="Close";m.onclick=function(){document.body.removeChild(k)};a?p.style.display="block":(n.style.display=
"block",!a&&i.itemType!=f._amazonServices.IAP.ItemType.CONSUMABLE&&f._webAppApiTester.grantEntitlement(b));f._amazonServices.IAP._runCallback(g.callbackName,g.response)},1E3)};d.appendChild(h);e=document.createElement("div");e.id="AmazonServicesPurchaseItem-Description";e.style.cssFloat="left";e.style.width="350px";e.style.marginTop="15px";e.style.marginBottom="15px";e.style.color="#bbb";e.style.fontSize="14px";e.innerHTML=i.description;d.appendChild(e);e=document.createElement("div");e.id="AmazonServicesPurchaseItem-Disclaimer";
e.style.cssFloat="left";e.style.width="350px";e.style.color="#999";e.style.fontSize="10px";e.innerHTML="Sold by Amazon Digital Services, Inc. Additional taxes may apply.";d.appendChild(e);c.appendChild(d);k.appendChild(c);document.body.appendChild(k)}}};function _MockAmazonJavascriptGameCircleBindings(a,b){this._init(a,b)}
_MockAmazonJavascriptGameCircleBindings.prototype={_amazonServices:null,_webAppApiTester:null,_init:function(a,b){this._amazonServices=a;this._webAppApiTester=b},_runDebugModeCallback:function(a,b){var c=this._webAppApiTester.getCallbackForMethod(a);null==c&&(c=this._webAppApiTester.createMockCallback(a,b));this._amazonServices.GameCircle._runCallback(c.callbackName,c.response)},initialize:function(){this._runDebugModeCallback("GameCircle.initialize",[])},synchronize:function(a){this._runDebugModeCallback("GameCircle.synchronize",
[a])},synchronizeProgress:function(a,b,c){this._runDebugModeCallback("GameCircle.synchronizeProgress",[a,b,c])},onNewGameDataReturnValue:function(){}};
(function(){var a=new _AmazonWebAppApiTester;window.amzn_wa_tester=a;amzn_wa&&!amzn_wa.enableApiTester&&(amzn_wa.enableApiTester=function(){if(amzn_wa.sdkPlatformMode==amzn_wa.SdkPlatformMode.JAVASCRIPT&&(a.initialize(amzn_wa),amzn_wa.IAP=new _AmazonInAppPurchasing.WebImpl(a),"undefined"!=typeof DocumentEventHandler&&DocumentEventHandler)){var b=DocumentEventHandler.getDocumentEventHandler();console.log("Tester platform is ready. Firing amazonPlatformReady event");b.addStickyDocumentEvent("amazonPlatformReady");
b.fireDocumentEvent("amazonPlatformReady")}})})();